// #include<stdio.h>


void reverse(char *arr, int n, int elemSize) {
  for (int i = 0; i < n / 2; i++) {
    int j = n - i - 1;
    char *to = arr + i * elemSize;
    char *from = arr + j * elemSize;
    for (int k = 0; k < elemSize; k++) {
      char c = from[k];
      from[k] = to[k];
      to[k] = c;
    }
  }
}

/////////////////// TESTS BEGIN ///////////////////

void call_reverse(char *arr, int n, int elemSize) {
	reverse(arr, n, elemSize);
}

#define ECALL(which, arg0)                                                     \
  ({                                                                           \
    register unsigned int a0 asm("a0") = (unsigned int)(which);                \
    register unsigned int a1 asm("a1") = (unsigned int)(arg0);                 \
    asm volatile("ecall" : "+r"(a0) : "r"(a1) : "memory");                     \
    a0;                                                                        \
  })

void ecall(int sys_no, int arg) { ECALL(sys_no, arg); }

// 1 if equal; 0 otherwise;
int is_equal(char *a, char *b, int n) {
  unsigned char diff = 0;
  for (int i = 0; i < n; i++) {
    diff |= a[i] ^ b[i];
  }
  return diff == 0;
}

#define run_test(test_name, in, out, sz)                                       \
  {                                                                            \
    call_reverse(in, sizeof(in) / sz, sz);                                          \
    ecall(4, (long)test_name);                                                 \
    ecall(1, is_equal(in, out, sizeof(out)));                                  \
    ecall(11, '\n');                                                           \
  }

// #define run_test(test_name, in, out, sz)                                       \
//   {                                                                            \
//     reverse(in, sizeof(in) / sz, sz);                                          \
//     printf("%s", test_name);                                                   \
//     printf("%d", is_equal(in, out, sizeof(out)));                              \
//     printf("\n");                                                              \
//   }

char in0[] = {19, 244};
char out0[] = {244, 19};

char in1[] = {252, 85, 221};
char out1[] = {221, 85, 252};

char in2[] = {130, 144, 50, 137};
char out2[] = {137, 50, 144, 130};

char in3[] = {105, 148, 111, 163, 233};
char out3[] = {233, 163, 111, 148, 105};

char in4[] = {31, 192, 116, 89, 248, 80};
char out4[] = {80, 248, 89, 116, 192, 31};

char in5[] = {19, 142, 70, 40, 189, 158, 183, 157, 142, 48,  138, 76, 214,
              17, 28,  47, 77, 228, 16,  189, 55,  153, 224, 197, 128};
char out5[] = {128, 197, 224, 153, 55,  189, 16,  228, 77, 47, 28,  17, 214,
               76,  138, 48,  142, 157, 183, 158, 189, 40, 70, 142, 19};

char in6[] = {53,  191, 164, 179, 231, 14,  18,  118, 1,   82,  121, 171, 186,
              28,  185, 9,   93,  53,  203, 203, 13,  4,   224, 97,  193, 29,
              204, 102, 236, 101, 32,  147, 232, 113, 65,  79,  206, 124, 40,
              62,  80,  174, 201, 7,   200, 35,  206, 127, 230, 36};
char out6[] = {36,  230, 127, 206, 35,  200, 7,   201, 174, 80,  62,  40,  124,
               206, 79,  65,  113, 232, 147, 32,  101, 236, 102, 204, 29,  193,
               97,  224, 4,   13,  203, 203, 53,  93,  9,   185, 28,  186, 171,
               121, 82,  1,   118, 18,  14,  231, 179, 164, 191, 53};

char in7[] = {41,  162, 125, 179, 130, 230, 65,  132, 228, 20,  244, 207, 48,
              180, 67,  32,  185, 234, 4,   240, 251, 193, 104, 121, 11,  87,
              114, 175, 73,  68,  11,  156, 86,  126, 238, 68,  99,  170, 128,
              236, 132, 252, 101, 213, 155, 137, 218, 222, 96,  246, 185, 97,
              54,  162, 225, 54,  236, 180, 173, 159, 17,  214, 124, 249, 48,
              0,   110, 223, 236, 144, 236, 43,  220, 34,  135, 225, 227, 241,
              106, 203, 120, 194, 154, 142, 226, 227, 81,  172, 212, 188, 61,
              211, 58,  61,  225, 84,  146, 127, 105, 83};
char out7[] = {83,  105, 127, 146, 84,  225, 61,  58,  211, 61,  188, 212, 172,
               81,  227, 226, 142, 154, 194, 120, 203, 106, 241, 227, 225, 135,
               34,  220, 43,  236, 144, 236, 223, 110, 0,   48,  249, 124, 214,
               17,  159, 173, 180, 236, 54,  225, 162, 54,  97,  185, 246, 96,
               222, 218, 137, 155, 213, 101, 252, 132, 236, 128, 170, 99,  68,
               238, 126, 86,  156, 11,  68,  73,  175, 114, 87,  11,  121, 104,
               193, 251, 240, 4,   234, 185, 32,  67,  180, 48,  207, 244, 20,
               228, 132, 65,  230, 130, 179, 125, 162, 41};

char in8[] = {171, 189, 21,  191, 217, 162, 117, 95,  228,
              73,  244, 241, 59,  121, 58,  2,   172, 46};
char out8[] = {2,   172, 46,  59,  121, 58,  73,  244, 241,
               117, 95,  228, 191, 217, 162, 171, 189, 21};

char in9[] = {190, 166, 90,  34,  75,  209, 53, 52,  217, 28, 161,
              76,  15,  155, 244, 132, 44,  6,  136, 173, 134};
char out9[] = {136, 173, 134, 132, 44, 6,  15,  155, 244, 28, 161,
               76,  53,  52,  217, 34, 75, 209, 190, 166, 90};

char in10[] = {66,  94,  209, 18,  170, 246, 92,  78,  60,  29,
               155, 66,  190, 248, 107, 152, 222, 206, 159, 123,
               53,  28,  122, 147, 87,  158, 172, 172, 36,  8,
               186, 129, 159, 120, 105, 251, 163, 217, 82,  31};
char out10[] = {163, 217, 82,  31,  159, 120, 105, 251, 36,  8,
                186, 129, 87,  158, 172, 172, 53,  28,  122, 147,
                222, 206, 159, 123, 190, 248, 107, 152, 60,  29,
                155, 66,  170, 246, 92,  78,  66,  94,  209, 18};

char in11[] = {186, 6,   205, 149, 182, 141, 1,   178, 120, 17,  67,  33,  92,
               7,   50,  32,  5,   196, 30,  187, 249, 53,  72,  93,  87,  151,
               233, 11,  72,  16,  29,  252, 197, 100, 140, 99,  44,  175, 56,
               92,  177, 72,  76,  177, 255, 74,  97,  158, 22,  252, 241, 9,
               154, 152, 216, 112, 115, 86,  131, 213, 97,  193, 250, 81,  50,
               199, 19,  87,  44,  30,  50,  12,  102, 140, 73,  104, 6,   38,
               232, 229, 62,  136, 13,  54,  44,  132, 149, 248, 253, 215, 219,
               83,  122, 230, 249, 149, 31,  136, 154, 40};
char out11[] = {31,  136, 154, 40,  122, 230, 249, 149, 253, 215, 219, 83,  44,
                132, 149, 248, 62,  136, 13,  54,  6,   38,  232, 229, 102, 140,
                73,  104, 44,  30,  50,  12,  50,  199, 19,  87,  97,  193, 250,
                81,  115, 86,  131, 213, 154, 152, 216, 112, 22,  252, 241, 9,
                255, 74,  97,  158, 177, 72,  76,  177, 44,  175, 56,  92,  197,
                100, 140, 99,  72,  16,  29,  252, 87,  151, 233, 11,  249, 53,
                72,  93,  5,   196, 30,  187, 92,  7,   50,  32,  120, 17,  67,
                33,  182, 141, 1,   178, 186, 6,   205, 149};

char in12[] = {81,  230, 18,  198, 192, 79,  72,  40,  149, 121, 95,  227,
               217, 158, 131, 51,  13,  136, 104, 136, 39,  120, 29,  162,
               238, 157, 154, 62,  90,  246, 122, 196, 63,  223, 148, 42,
               240, 106, 188, 77,  70,  59,  54,  44,  84,  245, 108, 69,
               169, 59,  116, 23,  181, 80,  199, 17,  183, 209, 6,   214,
               18,  12,  48,  202, 102, 145, 182, 90,  183, 250, 147, 232,
               220, 226, 117, 74,  128, 193, 151, 58,  21,  139, 252, 192,
               64,  165, 127, 221, 52,  57,  68,  239, 190, 221, 170, 77};
char out12[] = {64,  165, 127, 221, 52,  57,  68,  239, 190, 221, 170, 77,
                220, 226, 117, 74,  128, 193, 151, 58,  21,  139, 252, 192,
                18,  12,  48,  202, 102, 145, 182, 90,  183, 250, 147, 232,
                169, 59,  116, 23,  181, 80,  199, 17,  183, 209, 6,   214,
                240, 106, 188, 77,  70,  59,  54,  44,  84,  245, 108, 69,
                238, 157, 154, 62,  90,  246, 122, 196, 63,  223, 148, 42,
                217, 158, 131, 51,  13,  136, 104, 136, 39,  120, 29,  162,
                81,  230, 18,  198, 192, 79,  72,  40,  149, 121, 95,  227};

char in13[] = {
    69,  121, 217, 19,  179, 38,  152, 213, 204, 153, 111, 134, 15,  220, 168,
    188, 133, 176, 179, 134, 136, 35,  53,  167, 177, 179, 88,  236, 180, 180,
    79,  65,  22,  51,  189, 107, 183, 160, 223, 31,  217, 132, 238, 228, 210,
    116, 165, 155, 21,  168, 122, 76,  190, 91,  41,  66,  10,  228, 49,  194,
    201, 243, 209, 233, 59,  148, 225, 54,  193, 148, 202, 40,  238, 55,  112,
    202, 20,  34,  198, 195, 98,  225, 60,  147, 227, 91,  219, 45,  210, 135,
    134, 137, 206, 207, 176, 106, 141, 37,  194, 190, 183, 81,  231, 61,  26,
    224, 241, 220, 158, 144, 179, 49,  152, 132, 109, 164, 206, 111, 106, 181};
char out13[] = {
    158, 144, 179, 49,  152, 132, 109, 164, 206, 111, 106, 181, 141, 37,  194,
    190, 183, 81,  231, 61,  26,  224, 241, 220, 227, 91,  219, 45,  210, 135,
    134, 137, 206, 207, 176, 106, 238, 55,  112, 202, 20,  34,  198, 195, 98,
    225, 60,  147, 201, 243, 209, 233, 59,  148, 225, 54,  193, 148, 202, 40,
    21,  168, 122, 76,  190, 91,  41,  66,  10,  228, 49,  194, 183, 160, 223,
    31,  217, 132, 238, 228, 210, 116, 165, 155, 177, 179, 88,  236, 180, 180,
    79,  65,  22,  51,  189, 107, 15,  220, 168, 188, 133, 176, 179, 134, 136,
    35,  53,  167, 69,  121, 217, 19,  179, 38,  152, 213, 204, 153, 111, 134};

char in14[] = {
    157, 182, 105, 94,  80,  120, 246, 233, 159, 228, 205, 152, 247, 178, 185,
    154, 254, 202, 55,  158, 118, 214, 24,  95,  146, 82,  205, 68,  237, 205,
    76,  180, 192, 112, 9,   213, 159, 102, 196, 16,  164, 162, 255, 124, 23,
    87,  191, 245, 130, 201, 165, 212, 9,   196, 131, 24,  203, 253, 1,   1,
    189, 159, 69,  56,  155, 142, 31,  81,  197, 35,  45,  213, 136, 54,  202,
    34,  244, 37,  36,  81,  13,  48,  84,  89,  152, 76,  5,   147, 211, 149,
    188, 85,  179, 166, 121, 107, 48,  170, 98,  214, 209, 210, 37,  82,  180,
    184, 217, 252, 240, 167, 29,  252, 176, 196, 169, 141, 24,  120, 148, 39,
    48,  14,  53,  132, 33,  15,  71,  175, 114, 138, 32,  145, 138, 67,  175,
    213, 84,  222, 202, 252, 97,  8,   128, 8,   32,  135, 14,  70,  185, 97,
    116, 166, 63,  54,  49,  210, 189, 189, 230, 155, 21,  46,  42,  147, 69,
    190, 144, 64,  195, 115, 195, 92,  42,  219, 179, 63,  50,  200, 109, 28};
char out14[] = {
    195, 115, 195, 92,  42,  219, 179, 63,  50,  200, 109, 28,  189, 189, 230,
    155, 21,  46,  42,  147, 69,  190, 144, 64,  32,  135, 14,  70,  185, 97,
    116, 166, 63,  54,  49,  210, 138, 67,  175, 213, 84,  222, 202, 252, 97,
    8,   128, 8,   48,  14,  53,  132, 33,  15,  71,  175, 114, 138, 32,  145,
    240, 167, 29,  252, 176, 196, 169, 141, 24,  120, 148, 39,  48,  170, 98,
    214, 209, 210, 37,  82,  180, 184, 217, 252, 152, 76,  5,   147, 211, 149,
    188, 85,  179, 166, 121, 107, 136, 54,  202, 34,  244, 37,  36,  81,  13,
    48,  84,  89,  189, 159, 69,  56,  155, 142, 31,  81,  197, 35,  45,  213,
    130, 201, 165, 212, 9,   196, 131, 24,  203, 253, 1,   1,   159, 102, 196,
    16,  164, 162, 255, 124, 23,  87,  191, 245, 146, 82,  205, 68,  237, 205,
    76,  180, 192, 112, 9,   213, 247, 178, 185, 154, 254, 202, 55,  158, 118,
    214, 24,  95,  157, 182, 105, 94,  80,  120, 246, 233, 159, 228, 205, 152};

char in15[] = {
    160, 225, 114, 104, 147, 153, 86,  32,  20,  120, 186, 211, 224, 133, 62,
    45,  172, 163, 221, 220, 226, 38,  180, 88,  96,  1,   39,  123, 163, 64,
    227, 193, 127, 143, 167, 61,  101, 92,  22,  34,  95,  223, 27,  177, 114,
    199, 99,  105, 183, 150, 192, 204, 138, 189, 112, 48,  239, 156, 102, 38,
    23,  19,  194, 102, 191, 21,  27,  203, 195, 200, 115, 150, 201, 106, 62,
    93,  133, 243, 80,  144, 180, 227, 217, 172, 32,  17,  176, 163, 240, 1,
    97,  33,  5,   154, 254, 142, 23,  79,  126, 101, 174, 152, 116, 149, 158,
    152, 14,  83,  200, 4,   116, 71,  15,  15,  201, 25,  211, 19,  142, 124,
    16,  3,   227, 182, 146, 11,  150, 28,  100, 210, 244, 192, 34,  23,  13,
    193, 112, 123, 127, 122, 12,  15,  160, 30,  24,  142, 225, 248, 251, 185,
    194, 129, 22,  9,   40,  37,  14,  207, 15,  133, 211, 210, 120, 91,  169,
    142, 248, 51,  19,  182, 192, 25,  246, 198, 224, 179, 164, 29,  192, 0,
    134, 65,  195, 250, 47,  53,  216, 29,  4,   146, 206, 12,  94,  66,  30,
    162, 57,  144, 52,  234, 10,  59,  214, 199, 124, 226, 56,  0,   24,  213,
    237, 252, 122, 56,  87,  168, 211, 11,  131, 51,  54,  85,  208, 79,  145,
    32,  210, 175, 156, 56,  100, 232, 155, 44,  83,  235, 21,  122, 219, 11};
char out15[] = {
    156, 56,  100, 232, 155, 44,  83,  235, 21,  122, 219, 11,  211, 11,  131,
    51,  54,  85,  208, 79,  145, 32,  210, 175, 124, 226, 56,  0,   24,  213,
    237, 252, 122, 56,  87,  168, 94,  66,  30,  162, 57,  144, 52,  234, 10,
    59,  214, 199, 134, 65,  195, 250, 47,  53,  216, 29,  4,   146, 206, 12,
    19,  182, 192, 25,  246, 198, 224, 179, 164, 29,  192, 0,   14,  207, 15,
    133, 211, 210, 120, 91,  169, 142, 248, 51,  24,  142, 225, 248, 251, 185,
    194, 129, 22,  9,   40,  37,  34,  23,  13,  193, 112, 123, 127, 122, 12,
    15,  160, 30,  16,  3,   227, 182, 146, 11,  150, 28,  100, 210, 244, 192,
    200, 4,   116, 71,  15,  15,  201, 25,  211, 19,  142, 124, 23,  79,  126,
    101, 174, 152, 116, 149, 158, 152, 14,  83,  32,  17,  176, 163, 240, 1,
    97,  33,  5,   154, 254, 142, 201, 106, 62,  93,  133, 243, 80,  144, 180,
    227, 217, 172, 23,  19,  194, 102, 191, 21,  27,  203, 195, 200, 115, 150,
    183, 150, 192, 204, 138, 189, 112, 48,  239, 156, 102, 38,  101, 92,  22,
    34,  95,  223, 27,  177, 114, 199, 99,  105, 96,  1,   39,  123, 163, 64,
    227, 193, 127, 143, 167, 61,  224, 133, 62,  45,  172, 163, 221, 220, 226,
    38,  180, 88,  160, 225, 114, 104, 147, 153, 86,  32,  20,  120, 186, 211};

int main(int argc, char **argv) {
  run_test("[TEST #0]\tN=2\telemSize=1\tresult=\0", in0, out0, 1);

  run_test("[TEST #1]\tN=3\telemSize=1\tresult=\0", in1, out1, 1);

  run_test("[TEST #2]\tN=4\telemSize=1\tresult=\0", in2, out2, 1);

  run_test("[TEST #3]\tN=5\telemSize=1\tresult=\0", in3, out3, 1);

  run_test("[TEST #4]\tN=6\telemSize=1\tresult=\0", in4, out4, 1);

  run_test("[TEST #5]\tN=25\telemSize=1\tresult=\0", in5, out5, 1);

  run_test("[TEST #6]\tN=50\telemSize=1\tresult=\0", in6, out6, 1);

  run_test("[TEST #7]\tN=100\telemSize=1\tresult=\0", in7, out7, 1);

  run_test("[TEST #8]\tN=6\telemSize=3\tresult=\0", in8, out8, 3);

  run_test("[TEST #9]\tN=7\telemSize=3\tresult=\0", in9, out9, 3);

  run_test("[TEST #10]\tN=10\telemSize=4\tresult=\0", in10, out10, 4);

  run_test("[TEST #11]\tN=25\telemSize=4\tresult=\0", in11, out11, 4);

  run_test("[TEST #12]\tN=8\telemSize=12\tresult=\0", in12, out12, 12);

  run_test("[TEST #13]\tN=10\telemSize=12\tresult=\0", in13, out13, 12);

  run_test("[TEST #14]\tN=15\telemSize=12\tresult=\0", in14, out14, 12);

  run_test("[TEST #15]\tN=20\telemSize=12\tresult=\0", in15, out15, 12);

  ecall(10, 0);
}

/////////////////// TESTS END ///////////////////
